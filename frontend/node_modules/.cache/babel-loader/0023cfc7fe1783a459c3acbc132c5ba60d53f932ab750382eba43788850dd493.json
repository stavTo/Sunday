{"ast":null,"code":"import { storageService } from './async-storage.service.js';\nimport { utilService } from './util.service.js';\nimport { userService } from './user.service.js';\nconst STORAGE_KEY = 'board';\nexport const boardService = {\n  query,\n  getById,\n  save,\n  remove,\n  getEmptyBoard,\n  addBoardMsg\n};\nasync function query() {\n  let filterBy = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    txt: '',\n    price: 0\n  };\n  var boards = await storageService.query(STORAGE_KEY);\n  if (filterBy.txt) {\n    const regex = new RegExp(filterBy.txt, 'i');\n    boards = boards.filter(board => regex.test(board.vendor) || regex.test(board.description));\n  }\n  if (filterBy.price) {\n    boards = boards.filter(board => board.price <= filterBy.price);\n  }\n  return boards;\n}\nfunction getById(boardId) {\n  return storageService.get(STORAGE_KEY, boardId);\n}\nasync function remove(boardId) {\n  // throw new Error('Nope')\n  await storageService.remove(STORAGE_KEY, boardId);\n}\nasync function save(board) {\n  var savedBoard;\n  if (board._id) {\n    savedBoard = await storageService.put(STORAGE_KEY, board);\n  } else {\n    // Later, owner is set by the backend\n    board.owner = userService.getLoggedInUser();\n    savedBoard = await storageService.post(STORAGE_KEY, board);\n  }\n  return savedBoard;\n}\nasync function addBoardMsg(boardId, txt) {\n  // Later, this is all done by the backend\n  const board = await getById(boardId);\n  if (!board.msgs) board.msgs = [];\n  const msg = {\n    id: utilService.makeId(),\n    by: userService.getLoggedInUser(),\n    txt\n  };\n  board.msgs.push(msg);\n  await storageService.put(STORAGE_KEY, board);\n  return msg;\n}\nfunction getEmptyBoard() {\n  return {\n    _id: '',\n    title: '',\n    isStarred: false,\n    archivedAt: null,\n    createdBy: {\n      _id: '',\n      fullname: '',\n      imgUrl: ''\n    },\n    style: {},\n    members: [],\n    groups: [],\n    cmpsOrder: []\n  };\n}\nfunction _getDummyBoard(boardNum) {\n  return {\n    title: `board${boardNum}`,\n    isStarred: false,\n    archivedAt: 1589983468418,\n    createdBy: {\n      _id: 'u101',\n      fullname: 'Abi Abambi',\n      imgUrl: 'http://some-img'\n    },\n    style: {},\n    members: [{\n      _id: 'u101',\n      fullname: 'Tal Tarablus',\n      imgUrl: 'https://www.google.com'\n    }],\n    groups: [{\n      id: 'g101',\n      title: 'Group 1',\n      archivedAt: 1589983468418,\n      tasks: [{\n        id: 'c101',\n        title: 'Replace logo'\n      }, {\n        id: 'c102',\n        title: 'Add Samples'\n      }],\n      style: {}\n    }, {\n      id: 'g102',\n      title: 'Group 2',\n      tasks: [{\n        id: 'c103',\n        title: 'Do that',\n        archivedAt: 1589983468418\n      }, {\n        id: 'c104',\n        title: 'Help me',\n        status: 'in-progress',\n        // monday\n        priority: 'high',\n        description: 'description',\n        comments: [{\n          id: 'ZdPnm',\n          txt: 'also @yaronb please CR this',\n          createdAt: 1590999817436,\n          byMember: {\n            _id: 'u101',\n            fullname: 'Tal Tarablus',\n            imgUrl: 'http://res.cloudinary.com/shaishar9/image/upload/v1590850482/j1glw3c9jsoz2py0miol.jpg'\n          }\n        }],\n        checklists: [{\n          id: 'YEhmF',\n          title: 'Checklist',\n          todos: [{\n            id: '212jX',\n            title: 'To Do 1',\n            isDone: false\n          }]\n        }],\n        memberIds: ['u101'],\n        labelIds: ['l101', 'l102'],\n        dueDate: 16156215211,\n        byMember: {\n          _id: 'u101',\n          username: 'Tal',\n          fullname: 'Tal Tarablus',\n          imgUrl: 'http://res.cloudinary.com/shaishar9/image/upload/v1590850482/j1glw3c9jsoz2py0miol.jpg'\n        },\n        style: {\n          bgColor: '#26de81'\n        }\n      }],\n      style: {}\n    }],\n    cmpsOrder: ['status-picker', 'member-picker', 'date-picker']\n  };\n}\n\n// storageService.post(STORAGE_KEY, _getDummyBoard(1))","map":{"version":3,"names":["storageService","utilService","userService","STORAGE_KEY","boardService","query","getById","save","remove","getEmptyBoard","addBoardMsg","filterBy","arguments","length","undefined","txt","price","boards","regex","RegExp","filter","board","test","vendor","description","boardId","get","savedBoard","_id","put","owner","getLoggedInUser","post","msgs","msg","id","makeId","by","push","title","isStarred","archivedAt","createdBy","fullname","imgUrl","style","members","groups","cmpsOrder","_getDummyBoard","boardNum","tasks","status","priority","comments","createdAt","byMember","checklists","todos","isDone","memberIds","labelIds","dueDate","username","bgColor"],"sources":["C:/Users/Roni/Desktop/Local Dev/Monday/dev/Sunday/frontend/src/services/board.service.local.js"],"sourcesContent":["import { storageService } from './async-storage.service.js'\r\nimport { utilService } from './util.service.js'\r\nimport { userService } from './user.service.js'\r\n\r\nconst STORAGE_KEY = 'board'\r\n\r\nexport const boardService = {\r\n\tquery,\r\n\tgetById,\r\n\tsave,\r\n\tremove,\r\n\tgetEmptyBoard,\r\n\taddBoardMsg,\r\n}\r\n\r\nasync function query(filterBy = { txt: '', price: 0 }) {\r\n\tvar boards = await storageService.query(STORAGE_KEY)\r\n\tif (filterBy.txt) {\r\n\t\tconst regex = new RegExp(filterBy.txt, 'i')\r\n\t\tboards = boards.filter(board => regex.test(board.vendor) || regex.test(board.description))\r\n\t}\r\n\tif (filterBy.price) {\r\n\t\tboards = boards.filter(board => board.price <= filterBy.price)\r\n\t}\r\n\treturn boards\r\n}\r\n\r\nfunction getById(boardId) {\r\n\treturn storageService.get(STORAGE_KEY, boardId)\r\n}\r\n\r\nasync function remove(boardId) {\r\n\t// throw new Error('Nope')\r\n\tawait storageService.remove(STORAGE_KEY, boardId)\r\n}\r\n\r\nasync function save(board) {\r\n\tvar savedBoard\r\n\tif (board._id) {\r\n\t\tsavedBoard = await storageService.put(STORAGE_KEY, board)\r\n\t} else {\r\n\t\t// Later, owner is set by the backend\r\n\t\tboard.owner = userService.getLoggedInUser()\r\n\t\tsavedBoard = await storageService.post(STORAGE_KEY, board)\r\n\t}\r\n\treturn savedBoard\r\n}\r\n\r\nasync function addBoardMsg(boardId, txt) {\r\n\t// Later, this is all done by the backend\r\n\tconst board = await getById(boardId)\r\n\tif (!board.msgs) board.msgs = []\r\n\r\n\tconst msg = {\r\n\t\tid: utilService.makeId(),\r\n\t\tby: userService.getLoggedInUser(),\r\n\t\ttxt,\r\n\t}\r\n\tboard.msgs.push(msg)\r\n\tawait storageService.put(STORAGE_KEY, board)\r\n\r\n\treturn msg\r\n}\r\n\r\nfunction getEmptyBoard() {\r\n\treturn {\r\n\t\t_id: '',\r\n\t\ttitle: '',\r\n\t\tisStarred: false,\r\n\t\tarchivedAt: null,\r\n\t\tcreatedBy: { _id: '', fullname: '', imgUrl: '' },\r\n\t\tstyle: {},\r\n\t\tmembers: [],\r\n\t\tgroups: [],\r\n\t\tcmpsOrder: [],\r\n\t}\r\n}\r\n\r\nfunction _getDummyBoard(boardNum) {\r\n\treturn {\r\n\t\ttitle: `board${boardNum}`,\r\n\t\tisStarred: false,\r\n\t\tarchivedAt: 1589983468418,\r\n\t\tcreatedBy: {\r\n\t\t\t_id: 'u101',\r\n\t\t\tfullname: 'Abi Abambi',\r\n\t\t\timgUrl: 'http://some-img',\r\n\t\t},\r\n\t\tstyle: {},\r\n\t\tmembers: [\r\n\t\t\t{\r\n\t\t\t\t_id: 'u101',\r\n\t\t\t\tfullname: 'Tal Tarablus',\r\n\t\t\t\timgUrl: 'https://www.google.com',\r\n\t\t\t},\r\n\t\t],\r\n\t\tgroups: [\r\n\t\t\t{\r\n\t\t\t\tid: 'g101',\r\n\t\t\t\ttitle: 'Group 1',\r\n\t\t\t\tarchivedAt: 1589983468418,\r\n\t\t\t\ttasks: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'c101',\r\n\t\t\t\t\t\ttitle: 'Replace logo',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'c102',\r\n\t\t\t\t\t\ttitle: 'Add Samples',\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tstyle: {},\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: 'g102',\r\n\t\t\t\ttitle: 'Group 2',\r\n\t\t\t\ttasks: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'c103',\r\n\t\t\t\t\t\ttitle: 'Do that',\r\n\t\t\t\t\t\tarchivedAt: 1589983468418,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 'c104',\r\n\t\t\t\t\t\ttitle: 'Help me',\r\n\t\t\t\t\t\tstatus: 'in-progress', // monday\r\n\t\t\t\t\t\tpriority: 'high',\r\n\t\t\t\t\t\tdescription: 'description',\r\n\t\t\t\t\t\tcomments: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: 'ZdPnm',\r\n\t\t\t\t\t\t\t\ttxt: 'also @yaronb please CR this',\r\n\t\t\t\t\t\t\t\tcreatedAt: 1590999817436,\r\n\t\t\t\t\t\t\t\tbyMember: {\r\n\t\t\t\t\t\t\t\t\t_id: 'u101',\r\n\t\t\t\t\t\t\t\t\tfullname: 'Tal Tarablus',\r\n\t\t\t\t\t\t\t\t\timgUrl: 'http://res.cloudinary.com/shaishar9/image/upload/v1590850482/j1glw3c9jsoz2py0miol.jpg',\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tchecklists: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tid: 'YEhmF',\r\n\t\t\t\t\t\t\t\ttitle: 'Checklist',\r\n\t\t\t\t\t\t\t\ttodos: [\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tid: '212jX',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'To Do 1',\r\n\t\t\t\t\t\t\t\t\t\tisDone: false,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tmemberIds: ['u101'],\r\n\t\t\t\t\t\tlabelIds: ['l101', 'l102'],\r\n\t\t\t\t\t\tdueDate: 16156215211,\r\n\t\t\t\t\t\tbyMember: {\r\n\t\t\t\t\t\t\t_id: 'u101',\r\n\t\t\t\t\t\t\tusername: 'Tal',\r\n\t\t\t\t\t\t\tfullname: 'Tal Tarablus',\r\n\t\t\t\t\t\t\timgUrl: 'http://res.cloudinary.com/shaishar9/image/upload/v1590850482/j1glw3c9jsoz2py0miol.jpg',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tbgColor: '#26de81',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tstyle: {},\r\n\t\t\t},\r\n\t\t],\r\n\t\tcmpsOrder: ['status-picker', 'member-picker', 'date-picker'],\r\n\t}\r\n}\r\n\r\n// storageService.post(STORAGE_KEY, _getDummyBoard(1))\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}